sap.ui.define(["trainning/bp000/controller/BaseController","sap/m/MessageBox","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,r,o){"use strict";return e.extend("trainning.bp000.controller.BPDetail",{onInit:function(){this.attachRoute("ToBPDisplay",this.onRouteMatched);this.attachRoute("ToBPEdit",this.onRouteMatched);this.attachRoute("ToBPCreate",this.onRouteMatched)},onRouteMatched:function(e){var t=e.getParameter("name");var r=this.getView();if(t==="ToBPEdit"||t==="ToBPDisplay"){var o=e.getParameter("arguments").PartnerId;r.bindElement("/BusinessPartnerSet('"+o+"')")}else if(t==="ToBPCreate"){r.unbindContext();var n=r.getModel();var i=n.createEntry("/BusinessPartnerSet",{properties:{PartnerId:"",PartnerType:"",PartnerName1:"",PartnerName2:"",SearchTerm1:"",SearchTerm2:"",Street:"",HouseNumber:"",District:"",City:"",Region:"",Country:"",ZipCode:""}});r.setBindingContext(i)}if(t==="ToBPEdit"||t==="ToBPCreate"){this.setEditableControls(true)}else{this.setEditableControls(false)}switch(t){case"ToBPEdit":this._sOperation="Edit";break;case"ToBPDisplay":this._sOperation="Display";break;case"ToBPCreate":this._sOperation="Create";break}},setEditableControls:function(e){var t=new sap.ui.model.json.JSONModel;if(e){t.loadData("model/controlsOpened.json")}else{t.loadData("model/controlsClosed.json")}var r=this.getView();r.setModel(t,"control")},onSavePress:function(e){var r=this.getView();var o=r.getModel();var n=this;switch(this._sOperation){case"Edit":o.submitChanges({success:function(e,r){t.success(n.getText("msgBPUpdated"),{title:n.getText("txtBPUpdated"),onClose:function(e){n.getRouter().navTo("ToBPList")}})},error:function(e){t.error(n.getText("msgBPUpdError"),{title:n.getText("txtBPUpdError")})}});break;case"Create":var i=r.getBindingContext().getObject();o.create("/BusinessPartnerSet",i,{success:function(e,r){t.success(n.getText("msgBPCreated",[i.PartnerId]),{title:n.getText("txtBPCreated"),onClose:function(e){n.getRouter().navTo("ToBPList")}})},error:function(e){t.error(n.getText("msgBPCrtError"),{title:n.getText("txtBPCrtError")})}});break}},onCancelPress:function(e){var r=this.getView();var o=this;t.show(o.getText("msgBPCancel"),{title:o.getText("txtBPCancel"),actions:[t.Action.YES,t.Action.NO],onClose:function(e){if(e===t.Action.YES){r.getModel().resetChanges([r.getBindingContext().getPath()]);o.getRouter().navTo("ToBPList")}}})},onOpenCountryDialog:function(e){var t=this.getView();if(!this._oCountryDialog){this._oCountryDialog=new sap.ui.xmlfragment("trainning.bp000.fragments.CountryDialog",this);t.addDependent(this._oCountryDialog)}this._oCountryDialog.open()},onSearchCountryDialog:function(e){var t=e.getParameter("value");var n=new r("LandName",o.Contains,t);var i=e.getSource().getBinding("items");i.filter([n])},onCloseCountryDialog:function(e){var t=e.getParameter("selectedItem");var r=this.byId("inputCountry");if(t){r.setValue(t.getTitle());r.setDescription(t.getDescription())}else{r.resetProperty("value");r.resetProperty("description")}},onBlockPress:function(e){debugger;var r=this.getView();var o=r.getModel();var n=r.getBindingContext().getObject();var i=this;o.callFunction("/SetBusinessPartnerBlock",{method:"POST",urlParameters:{PartnerId:n.PartnerId,Block:!n.CentralBlock},success:function(e,r){debugger;if(e.Type!=="E"){t.success(e.Message,{title:i.getText("txtBPBlock"),onClose:function(e){i.getRouter().navTo("ToBPList")}})}else{t.error(e.Message,{title:i.getText("txtBPBlock")})}},error:function(e){debugger;t.error(i.getText("msgBPBlockError"),{title:i.getText("txtBPBlock")})}})}})});